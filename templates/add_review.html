{% extends 'index.html' %}

{% block content %}
  <h2>Add Review</h2>
  <form method="post" id="reviewForm">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Submit">
  </form>
  <script>
      $('#id_author').change(function(){
        var authorId = $(this).val();

        $.ajax({
          url: '/add-opinion',  // Make sure this URL is correct based on your project structure
          data: {'author_id': authorId},
          success: function(data){
              console.log("odp", data)
            // Clear previous options
            $('#id_title').empty();
            // Populate title options
            $.each(data, function(index, book) {
              $('#id_title').append('<option value="' + book.id + '">' + book.title + '</option>');
            });
          }
        });
      });
  </script>
{% endblock %}
